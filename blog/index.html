<!doctype html><html lang=en-us class=dark><head>
<meta charset=utf-8>
<meta http-equiv=content-language content="en-US">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>Elevation profile of Spain in R &#183; Julia G. de Aledo</title>
<meta name=title content="Elevation profile of Spain in R &#183; Julia G. de Aledo">
<meta name=description content="Have you ever wondered what would be of Spain if you cut it in half?">
<meta name=robots content="all">
<link rel=canonical href=https://juliagdealedo.github.io/blog/>
<link rel=alternate type=application/rss+xml href=/blog/index.xml title="Julia G. de Aledo">
<link type=text/css rel=stylesheet href=/css/schemes/avocado.min.22d40efa0787e9b20acd69125bc170d314a9add3ce43ce84c672c1bd033bc3dddb3c86fe98e871624a10c8daa3b0d716be9cab3c4575ca61e0e2f2f05c3e3d05.css integrity="sha512-ItQO+geH6bIKzWkSW8Fw0xSprdPOQ86ExnLBvQM7w93bPIb+mOhxYkoQyNqjsNcWvpyrPEV1ymHg4vLwXD49BQ==">
<link type=text/css rel=stylesheet href=/css/compiled/main.min.4076b9cf114dd23cca017f3365e2205a4c9a4b2c0ef4193ccd08883f76e554aa40f674a8f6e77a1b2895be0975ba8e019b0c59996c2eea32e4970ca4d5221653.css integrity="sha512-QHa5zxFN0jzKAX8zZeIgWkyaSywO9Bk8zQiIP3blVKpA9nSo9ud6GyiVvgl1uo4BmwxZmWwu6jLklwyk1SIWUw==">
<script>localStorage.removeItem("preferredAppearance")</script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<meta property="og:title" content="Elevation profile of Spain in R">
<meta property="og:description" content="Have you ever wondered what would be of Spain if you cut it in half?">
<meta property="og:type" content="website">
<meta property="og:url" content="https://juliagdealedo.github.io/blog/">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Elevation profile of Spain in R">
<meta name=twitter:description content="Have you ever wondered what would be of Spain if you cut it in half?">
<meta name=generator content="Hugo 0.90.1">
<meta name=author content="Julia G. de Aledo">
<link href=https://twitter.com/juliagdealedo rel=me>
<link href=mailto:julia.gonzalezdealedo@uam.es rel=me>
<link href=https://linkedin.com/ rel=me>
<link href=https://www.youtube.com/channel/UCgnkevuKdftZyKzGHGEVNSg/featured rel=me>
</head>
<body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-800 dark:text-neutral">
<div>
<a class="hover:underline hover:underline-primary-500 hover:underline-thickness-bold hover:underline-offset-small" rel=me href=/>Julia G. de Aledo</a>
</div>
<nav>
<ul class="flex flex-col list-none sm:flex-row">
<li class="mb-1 text-right sm:mb-0 sm:mr-7 sm:last:mr-0">
<a class="hover:underline hover:underline-primary-500 hover:underline-thickness-bold hover:underline-offset-small" href=/about/ title="About me">About me</a>
</li>
<li class="mb-1 text-right sm:mb-0 sm:mr-7 sm:last:mr-0">
<a class="hover:underline hover:underline-primary-500 hover:underline-thickness-bold hover:underline-offset-small" href=/projects/ title=Projects>Projects</a>
</li>
<li class="mb-1 text-right sm:mb-0 sm:mr-7 sm:last:mr-0">
<a class="hover:underline hover:underline-primary-500 hover:underline-thickness-bold hover:underline-offset-small" href=/publications/ title=Publications>Publications</a>
</li>
<li class="mb-1 text-right sm:mb-0 sm:mr-7 sm:last:mr-0">
<a class="hover:underline hover:underline-primary-500 hover:underline-thickness-bold hover:underline-offset-small" href=/blog/ title="Elevation profile of Spain in R">Blog</a>
</li>
</ul>
</nav>
</header>
<main class=flex-grow>
<header>
<section class="prose dark:prose-light">
<h1 class="mb-3 text-4xl font-extrabold text-neutral-800">Elevation profile of Spain in R</h1>
<section><h2 id=from-picos-de-europa-to-sierra-nevada>From Picos de Europa to Sierra Nevada <a class=heading-anchor href=#from-picos-de-europa-to-sierra-nevada aria-label=Anchor>#</a></h2>
<p>Have you ever wondered what would be of Spain if you cut it in half?
What is there after Despeñaperros?
Who is taller, meseta norte or meseta sur?
How come Ávila is the highest capital province in Spain?!</p>
<p>I did, and here is the result:</p>
<p><img src=/img/profile_1.png alt=profile></p>
<p><em>Indeed, after Despeñaperros, there is a big hole.</em></p>
<p>Here some tips to your elevation profile in R</p>
<h2 id=step-by-step>Step by step <a class=heading-anchor href=#step-by-step aria-label=Anchor>#</a></h2>
<ol>
<li>
<p>Download DEM (e.g. for Spain: <a href=http://www.ign.es/web/ign/portal>IGN</a>)</p>
</li>
<li>
<p>Download line shapefile with the trajectory of your profile (e.g. from GIS)</p>
</li>
<li>
<p>Download world map contour countries</p>
</li>
<li>
<p>Load all to R</p>
</li>
<li>
<p>Convert line to points</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r> <span style=color:#75715e># Obtain line elevation values</span>
 line2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>spTransform</span>(line, <span style=color:#e6db74>&#34;+init=epsg:25830&#34;</span>)
 psp <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.psp.SpatialLines</span>(line2)
 pts <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>pointsOnLines</span>(psp, eps<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)
 <span style=color:#75715e># Convert to spatial points</span>
 pts1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>SpatialPoints</span>(coords <span style=color:#f92672>=</span> <span style=color:#a6e22e>cbind</span>(pts<span style=color:#f92672>$</span>x, pts<span style=color:#f92672>$</span>y), proj4string <span style=color:#f92672>=</span> <span style=color:#a6e22e>CRS</span>(<span style=color:#e6db74>&#34;+init=epsg:25830&#34;</span>))
 pdf_data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(pts1)
</code></pre></div></li>
<li>
<p>Calculate elevation and distance</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r>pdf_data<span style=color:#f92672>$</span>dem <span style=color:#f92672>&lt;-</span> raster<span style=color:#f92672>::</span><span style=color:#a6e22e>extract</span>(r0, pts1) 
pdf_data<span style=color:#f92672>$</span>dist <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq</span>(<span style=color:#ae81ff>0</span>, (<span style=color:#a6e22e>nrow</span>(pdf_data)<span style=color:#ae81ff>-1</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>)
pdf_data<span style=color:#f92672>$</span>dist <span style=color:#f92672>&lt;-</span> pdf_data<span style=color:#f92672>$</span>dist<span style=color:#f92672>/</span><span style=color:#ae81ff>1000</span> <span style=color:#75715e># to km</span>
</code></pre></div></li>
<li>
<p>Plot it with ggplot</p>
<ul>
<li>
<p><code>geom_line</code> with MetPalettes color <a href=https://github.com/BlakeRMills/MetBrewer>Hokusai</a></p>
</li>
<li>
<p><code>geom_label_repel</code> to add the labels</p>
</li>
<li>
<p><code>theme_solarized</code> for background color</p>
</li>
<li>
<p><code>geom_polygon</code> to plot the Spain contour</p>
</li>
<li>
<p><code>inset_element</code> to add it to the previous graph</p>
</li>
</ul>
</li>
</ol>
<p>Find here the <a href=https://github.com/juliagdealedo/elevation-profile>full code</a></p>
</section>
</section>
</header>
<section>
<article>
<h3 class="flex items-center mt-6 text-xl font-semibold">
<a class="hover:underline hover:underline-primary-500 hover:underline-offset-small text-neutral-800 dark:text-neutral" href=/blog/elevation-profile/>Elevation profile of Spain in R</a>
</h3>
<div class="text-sm text-neutral-400 dark:text-neutral-500">
<div class="flex flex-row items-center">
</div>
</div>
<div class="py-1 prose dark:prose-light">
From Picos de Europa to Sierra Nevada # Have you ever wondered what would be of Spain if you cut it in half? What is there after Despeñaperros? Who is taller, meseta norte or meseta sur? How come Ávila is the highest capital province in Spain?!
I did, and here is the result:
Indeed, after Despeñaperros, there is a big hole.
Here some tips to your elevation profile in R
</div>
</article>
</section>
</main><footer class=py-10>
<div class="flex justify-between">
<div>
<p class="text-sm text-neutral-400 dark:text-neutral-500">
&copy;
2021
Julia G. de Aledo
</p>
<p class="text-xs text-neutral-300 dark:text-neutral-600">
Powered by <a class="hover:underline hover:underline-primary-300 hover:text-primary-400" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:underline-primary-300 hover:text-primary-400" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a>
</p>
</div>
</div>
</footer>
</body>
</html>